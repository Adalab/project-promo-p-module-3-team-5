"use strict";const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result}function fakeFileClick(){fileField.click()}function getElement(e){return document.querySelector(e)}fileField.addEventListener("change",getImage);const shareBtn=getElement(".js-share-container"),shareMsg=getElement(".js-share-article"),designBox=getElement(".js-designBox"),colourDropDown=getElement(".js-colour"),designArrow=getElement(".js-designArrow"),inputCircle1=getElement(".js-inputColor1"),inputCircle2=getElement(".js-inputColor2"),inputCircle3=getElement(".js-inputColor3"),cardProfile=getElement(".js-palette"),nameForm=getElement(".js__fillIn__name"),form=getElement(".js_form"),jobForm=getElement(".js__fillIn__job"),nameProfile=getElement(".js__card__name"),jobProfile=getElement(".js__card__job"),emailProfile=getElement(".js_email"),phoneProfile=getElement(".js_phone"),linkedinProfile=getElement(".js_linkedin"),githubProfile=getElement(".js_github"),resetButton=getElement(".js__reset"),formFieldsets=document.querySelectorAll(".js-form-fieldset"),shareTwitterBtn=document.querySelector(".js_twitterShareBtn"),URLCard=getElement(".js_URL"),feedback=getElement(".js_message_error");let data={name:"",job:"",email:"",phone:"",linkedin:"",github:"",palette:1,photo:""};function modifyCardClasses(e,t,a){cardProfile.classList.add(e),cardProfile.classList.remove(t),cardProfile.classList.remove(a)}function collapseFieldsetsExceptCurrent(e){formFieldsets.forEach(t=>{t!==e.currentTarget.parentElement&&t.classList.add("collapsed")}),shareBtn.classList.contains("white")&&(shareBtn.classList.remove("white"),feedback.innerHTML="")}console.log(">> Ready :)");for(const e of formFieldsets){e.querySelector(".js-form-title").addEventListener("click",t=>{collapseFieldsetsExceptCurrent(t),e.classList.toggle("collapsed")})}function handleKeyup(e){const t=e.target;"name"===t.name?(data.name=t.value,nameProfile.innerHTML=data.name,""===t.value&&(nameProfile.innerHTML="Escribe tu nombre")):"job"===t.name?(jobProfile.innerHTML=data.job,data.job=t.value,""===t.value&&(jobProfile.innerHTML="Escribe tu profesion")):"email"===t.name?data.email=t.value:"phone"===t.name?data.phone=t.value:"linkedin"===t.name?data.linkedin=t.value:"github"===t.name&&(data.github=t.value),renderPreview()}function handleReset(){console.log("click");const e=document.querySelector(".js__profile-image"),t=document.querySelector(".js__profile-preview");return form.reset(),nameProfile.innerHTML="Nombre profile",jobProfile.innerHTML="Front-end developer",emailProfile.href="",linkedinProfile.href="",githubProfile.href="",modifyCardClasses("palette3","palette2","palette1"),t.style.backgroundImage="",e.style.backgroundImage="url(./assets/images/imagen-chica.png)",data={name:"",job:"",email:"",phone:"",linkedin:"",github:"",palette:3,photo:""},data}function renderPreview(){emailProfile.href="mailto:"+data.email,linkedinProfile.href=""+data.linkedin,githubProfile.href=""+data.github,phoneProfile.href=""+data.phone}function createCard(e){e.preventDefault(),console.log(data),""!==data.name&&""!==data.job&&""!==data.linkedin&&""!==data.github&&""!==data.photo&&""!==data.palette&&""!==data.email?(feedback.innerHTML="",shareBtn.classList.remove("white"),fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{e.success&&(feedback.innerHTML="Genial, la tarjeta ha sido creada!",shareBtn.classList.add("white"),URLCard.innerHTML=e.cardURL,URLCard.href=e.cardURL,localStorage.setItem("data",JSON.stringify(data)))}),shareTwitterBtn.removeAttribute("disabled")):feedback.innerHTML="Falta algún dato en el formulario"}function shareOnTwitter(e){e.preventDefault(),console.log(URLCard.href);let t="https://twitter.com/intent/tweet?text=He%20creado%20una%20tarjeta%20profesional.%20Conóceme!%20&url="+URLCard.href;window.location.href=t}function initApp(){const e=localStorage.getItem("data");if(null!==e){const t=JSON.parse(e);data=t,nameProfile.innerHTML=data.name,jobProfile.innerHTML=data.job,emailProfile.href="mailto:"+data.email,phoneProfile.href="tel:"+data.phone,linkedinProfile.href=data.linkedin,githubProfile.href=data.github,profileImage.style.backgroundImage=`url(${data.photo})`,profilePreview.style.backgroundImage=`url(${data.photo})`}}inputCircle1.addEventListener("click",()=>{modifyCardClasses("palette3","palette2","palette1"),data.palette=1}),inputCircle2.addEventListener("click",()=>{modifyCardClasses("palette2","palette3","palette1"),data.palette=2}),inputCircle3.addEventListener("click",()=>{modifyCardClasses("palette1","palette3","palette2"),data.palette=3}),resetButton.addEventListener("click",handleReset),form.addEventListener("keyup",handleKeyup),shareBtn.addEventListener("click",e=>{e.preventDefault(),shareBtn.classList.add("white"),shareMsg.classList.remove("hidden")}),shareBtn.addEventListener("click",createCard),shareTwitterBtn.addEventListener("click",shareOnTwitter),initApp();